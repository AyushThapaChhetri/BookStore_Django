{% load stock_form_tags %}
<div class="relative z-0 w-full mb-5 group">
    {% if field|widget_type == "file" %}
        <!-- File Input -->
        <input
                type="file"
                name="{{ field.html_name }}"
                id="{{ field.id_for_label }}"
                class="block py-2.5 px-0 w-full text-[16px] text-gray-900 bg-transparent border-0 border-b-2 {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %} appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer"
        />
        <label
                for="{{ field.id_for_label }}"
                class="peer-focus:font-medium absolute text-sm text-gray-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
        >
            {{ field.label }}
        </label>
        {% if field.value %}
            <p class="mt-2 text-sm text-gray-600">
                Currently:
                <a href="{{ field.value.url }}" target="_blank" class="text-blue-600 underline">
                    {{ field.value.name }}
                </a>
            </p>
        {% endif %}

    {% elif field|widget_type == "textarea" %}
        <!-- Textarea -->
        <textarea
                name="{{ field.html_name }}"
                id="{{ field.id_for_label }}"
                rows="5"
                class="block py-2.5 px-0 w-full text-[16px] text-gray-900 bg-transparent border-0 border-b-2 {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %} appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer resize-vertical"
                placeholder=" "
        >{{ field.value|default_if_none:'' }}</textarea>
        <label
                for="{{ field.id_for_label }}"
                class="peer-focus:font-medium absolute text-sm text-gray-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
        >
            {{ field.label }}
        </label>

    {% elif field|widget_type == "select" %}

        <div class="flex flex-row mb-4 gap-2">
            <div class="flex flex-col grow ">
                <!-- Single Select -->
                <select
                        name="{{ field.html_name }}"
                        id="{{ field.id_for_label }}"
                        class="single_select_book block  py-2.5 px-0 w-full text-[16px] text-gray-900 bg-transparent border-0 border-b-2 {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %} appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                >

                    {% for choice_value, choice_label in field.field.choices %}
                        <option value="{{ choice_value }}"
                                {% if choice_value|stringformat:"s" == field.value|stringformat:"s" %}selected{% endif %}>
                            {{ choice_label }}
                        </option>
                    {% endfor %}
                </select>
                <label
                        for="{{ field.id_for_label }}"
                        class="block text-sm font-medium text-gray-500 mb-1"

                        {#                                        class="peer-focus:font-medium absolute text-sm text-gray-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"#}
                >
                    {{ field.label }}
                </label>
            </div>

            {#            <button class="h-fit p-1 border-[0.2px] border-gray-200 shadow-xl rounded-md active:bg-blue-200 active:border-white active:text-white"#}
            {#                    type="button" onclick="openModal('{{ field.name }}', '{{ field.id_for_label }}')">#}
            {##}
            {#                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"#}
            {#                     stroke-width="1.5"#}
            {#                     stroke="currentColor" class="size-5">#}
            {#                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"/>#}
            {#                </svg>#}
            {#            </button>#}

        </div>

    {% elif field|widget_type == "select_multiple" %}
        <div class="flex flex-row gap-2">
            <div class="flex flex-col grow ">


                <!-- Multiple Select -->
                <select
                        name="{{ field.html_name }}"
                        id="{{ field.id_for_label }}"
                        multiple
                        class="multi_select_book block py-2.5 px-2 w-full text-[16px] text-gray-900 bg-white border-2 {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent min-h-[100px]"
                        class=" block py-2.5 px-2 w-full text-[16px] text-gray-900 bg-white border-2 {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent min-h-[100px]"
                >
                    {% for choice_value, choice_label in field.field.choices %}
                        <option value="{{ choice_value }}"
                                {% if field.value and choice_value in field.value %}selected{% endif %}>

                            {{ choice_label }}
                        </option>
                    {% endfor %}
                </select>
                <label
                        for="{{ field.id_for_label }}"
                        class="block text-sm font-medium text-gray-500 mb-1"
                >
                    {{ field.label }} (Hold Ctrl/Cmd to select multiple)
                </label>

            </div>
            {#            <button class="h-fit p-1 border-[0.2px] border-gray-200 shadow-xl rounded-md active:bg-blue-200 active:border-white active:text-white"#}
            {#                    type="button" onclick="openModal('{{ field.name }}', '{{ field.id_for_label }}')">#}
            {##}
            {#                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"#}
            {#                     stroke-width="1.5"#}
            {#                     stroke="currentColor" class="size-5">#}
            {#                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"/>#}
            {#                </svg>#}
            {#            </button>#}

        </div>

    {% elif field|widget_type == "date" %}
        <!-- Date Input -->
        <input
                type="date"
                name="{{ field.html_name }}"
                id="{{ field.id_for_label }}"

                value="{{ field.value|date_input_value }}"
                {#                                value="{{ field.value|default_if_none:''|date:'Y-m-d' }}"#}
                class="block py-2.5 px-0 w-full text-[16px] text-gray-900 bg-transparent border-0 border-b-2
               {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %}
               appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                placeholder=" "
        />
        <label
                for="{{ field.id_for_label }}"
                class="peer-focus:font-medium absolute text-sm text-gray-500 duration-300 transform -translate-y-6 scale-75
               top-3 -z-10 origin-[0] peer-focus:text-blue-600 peer-placeholder-shown:scale-100
               peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
        >
            {{ field.label }}
        </label>

    {% else %}
        <!-- Regular Input Fields -->

        <input
                type="{{ field|input_type }}"
                name="{{ field.html_name }}"
                id="{{ field.id_for_label }}"
                value="{{ field.value|default_if_none:'' }}"
                class="block py-2.5 px-0 w-full text-[16px] text-gray-900 bg-transparent border-0 border-b-2 {% if field.errors %}border-red-500{% else %}border-gray-300{% endif %} appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer"
                placeholder=" "
        />
        <label
                for="{{ field.id_for_label }}"
                class="peer-focus:font-medium absolute text-sm text-gray-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
        >
            {{ field.label }}
        </label>
    {% endif %}

    {% if field.errors %}
        {% for error in field.errors %}
            <p class="text-red-500 text-sm mt-1">{{ error }}</p>
        {% endfor %}
    {% endif %}
</div>